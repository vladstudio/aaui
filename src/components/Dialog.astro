---
import {Icon} from "astro-icon/components"
const {width = "max-w-sm"} = Astro.props
---

<div
   x-data="{ open: false }"
   @keydown.escape="$dispatch('set-modal', false)"
   @set-modal="open = $event.detail; document.body.style.overflowY = open ? 'hidden' : ''">
   <!-- trigger -->
   <span @click="$dispatch('set-modal', true)" :disabled="open">
      <slot name="trigger" />
   </span>

   
   <!-- backdrop -->
   <div
      x-cloak
      x-transition.opacity
      class="fixed left-0 top-0 z-30 flex h-[100dvh] w-[100dvw] items-center justify-center overflow-auto bg-stone-300/30"
      x-show="open"
      x-trap="open">
      <!-- window -->
      <div
         class={width +
            " mx-auto grid w-full gap-4 rounded border border-stone-300 bg-white p-2 text-left shadow-2xl shadow-stone-900/10"}
         @click.away="$dispatch('set-modal', false)">
         <!-- header -->
         <div class="flex w-full items-center truncate">
            <h5 class="max-w-none flex-1 truncate pl-2"><slot name="title" /></h5>

            <button
               class="z-50 cursor-pointer p-2 hover:bg-stone-100"
               @click="$dispatch('set-modal', false)">
               <Icon name="ph:x-bold" size={16} class="text-stone-500" />
            </button>
         </div>

         <!-- content -->
         <div class="p-2">
            <slot />
         </div>
      </div>
   </div>
</div>
